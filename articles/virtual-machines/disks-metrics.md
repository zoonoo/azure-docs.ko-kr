---
title: 디스크 메트릭
description: 디스크 버스팅 메트릭의 예
author: roygara
ms.service: virtual-machines
ms.topic: conceptual
ms.date: 02/12/2021
ms.author: rogarana
ms.subservice: disks
ms.openlocfilehash: 60486c41ad843cf193ee0648dfcfef66f7668e47
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/29/2021
ms.locfileid: "101674974"
---
# <a name="disk-performance-metrics"></a>디스크 성능 메트릭
Azure는 VM(가상 머신) 및 디스크의 성능에 대한 인사이트를 제시하는 메트릭을 Azure Portal에서 제공합니다. API 호출을 통해 이러한 메트릭을 검색할 수도 있습니다. 이 문서는 세 개의 하위 섹션으로 나뉩니다.

- **디스크 IO, 처리량 및 큐 깊이 메트릭** - 이 메트릭으로 디스크 및 가상 머신의 관점에서 스토리지 성능을 확인할 수 있습니다.
- **디스크 버스팅 메트릭** - 이 메트릭으로 프리미엄 디스크에서 [버스팅](disk-bursting.md) 기능을 관찰할 수 있습니다.
- **스토리지 IO 사용 메트릭** - 이 메트릭으로 디스크의 스토리지 성능 병목 상태를 진단할 수 있습니다. 

5분 간격으로 내보내는 버스팅 크레딧 백분율 메트릭을 제외한 나머지 모든 메트릭은 1분마다 내보냅니다.

## <a name="disk-io-throughput-and-queue-depth-metrics"></a>디스크 IO, 처리량 및 큐 깊이 메트릭
다음 메트릭을 사용하여 VM 및 디스크 IO, 처리량 및 큐 깊이 성능에 대한 인사이트를 얻을 수 있습니다.

- **OS 디스크 큐 깊이**: OS 디스크에서 읽기 또는 쓰기 대기 중인 현재의 미해결 IO 요청 수입니다.
- **OS 디스크 읽기 바이트/초**: OS 디스크에서 1초 동안 읽는 바이트 수입니다.
- **OS 디스크 읽기 작업/초**: OS 디스크에서 1초 동안 읽는 입력 작업 수입니다.
- **OS 디스크 쓰기 바이트/초**: OS 디스크에서 1초 동안 쓰는 바이트 수입니다.
- **OS 디스크 쓰기 작업/초**: OS 디스크에서 1초 동안 쓰는 출력 작업 수입니다.
- **데이터 디스크 큐 깊이**: 데이터 디스크에서 읽기 또는 쓰기 대기 중인 현재의 미해결 IO 요청 수입니다.
- **데이터 디스크 읽기 바이트/초**: 데이터 디스크에서 1초 동안 읽는 바이트 수입니다.
- **데이터 디스크 읽기 작업/초**: 데이터 디스크에서 1초 동안 읽는 입력 작업 수입니다.
- **데이터 디스크 쓰기 바이트/초**: 데이터 디스크에서 1초 동안 쓰는 바이트 수입니다.
- **데이터 디스크 쓰기 작업/초**: 데이터 디스크에서 1초 동안 쓰는 출력 작업 수입니다.
- **디스크 읽기 바이트/초**: VM에 연결된 모든 디스크에서 1초 동안 읽는 총 바이트 수입니다.
- **디스크 읽기 작업/초**: VM에 연결된 모든 디스크에서 1초 동안 읽는 입력 작업 수입니다.
- **디스크 쓰기 바이트/초**: VM에 연결된 모든 디스크에서 1초 동안 쓰는 총 바이트 수입니다.
- **디스크 쓰기 작업/초**: VM에 연결된 모든 디스크에서 1초 동안 쓰는 출력 작업 수입니다.

## <a name="bursting-metrics"></a>버스팅 메트릭
다음 메트릭은 프리미엄 디스크에서 [버스팅](disk-bursting.md) 기능을 관찰하는 데 도움이 됩니다.

- **데이터 디스크 최대 버스팅 대역폭**: 데이터 디스크를 버스팅할 수 있는 처리량 한도입니다.
- **OS 디스크 최대 버스팅 대역폭**: OS 디스크를 버스팅할 수 있는 처리량 한도입니다.
- **데이터 디스크 최대 버스팅 IOPS**: 데이터 디스크를 버스팅할 수 있는 IOPS 한도입니다.
- **OS 디스크 최대 버스팅 IOPS**: OS 디스크를 버스팅할 수 있는 IOPS 한도입니다.
- **데이터 디스크 대상 대역폭**: 데이터 디스크가 버스팅 없이 달성 가능한 처리량 한도입니다.
- **OS 디스크 대상 대역폭**: OS 디스크가 버스팅 없이 달성 가능한 처리량 한도입니다.
- **데이터 디스크 대상 IOPS**: 데이터 디스크가 버스팅 없이 달성 가능한 IOPS 한도입니다.
- **OS 디스크 대상 IOPS**: OS 디스크가 버스팅 없이 달성 가능한 IOPS 한도입니다.
- **데이터 디스크 사용 버스팅 BPS 크레딧 백분율**: 데이터 디스크에 사용되는 처리량 버스팅의 누적 백분율입니다. 5분 간격으로 내보냅니다.
- **OS 디스크 사용 버스팅 BPS 크레딧 백분율**: OS 디스크에 사용되는 처리량 버스팅의 누적 백분율입니다. 5분 간격으로 내보냅니다.
- **데이터 디스크 사용 버스팅 IO 크레딧 백분율**: 데이터 디스크에 사용되는 IOPS 버스팅의 누적 백분율입니다. 5분 간격으로 내보냅니다.
- **OS 디스크 사용 버스팅 IO 크레딧 백분율**: OS 디스크에 사용되는 IOPS 버스팅의 누적 백분율입니다. 5분 간격으로 내보냅니다.

## <a name="storage-io-utilization-metrics"></a>스토리지 IO 사용률 메트릭
다음 메트릭은 Virtual Machine과 Disk 조합의 병목 상태를 진단하는 데 도움이 됩니다. 이러한 메트릭은 프리미엄 사용 VM을 사용하는 경우에만 제공됩니다. 이 메트릭은 Ultra를 제외한 모든 디스크 유형에 사용할 수 있습니다. 

디스크 IO 상한 도달을 진단하는 데 도움이 되는 메트릭:

- **데이터 디스크 IOPS 사용 백분율**: 프로비전된 데이터 디스크 IOPS 대비, 완료된 데이터 디스크 IOPS로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 데이터 디스크의 IOPS 한도로 인해 IO가 제한됩니다.
- **데이터 디스크 대역폭 사용 백분율**: 프로비전된 데이터 디스크 처리량 대비, 완료된 데이터 디스크 처리량으로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 데이터 디스크의 대역폭 한도로 인해 IO가 제한됩니다.
- **OS 디스크 대역폭 사용 백분율**: 프로비전된 OS 디스크 IOPS 대비, 완료된 OS 디스크 IOPS로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 OS 디스크의 IOPS 한도로 인해 IO가 제한됩니다.
- **OS 디스크 대역폭 사용 백분율**: 프로비전된 OS 디스크 처리량 대비, 완료된 OS 디스크 처리량으로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 OS 디스크의 대역폭 한도로 인해 IO가 제한됩니다.

VM IO 제한을 진단하는 데 도움이 되는 메트릭:

- **VM의 캐시된 IOPS 사용 백분율**: 캐시된 최대 가상 머신 IOPS 한도 대비, 완료된 총 IOPS로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 VM의 캐시된 IOPS 한도로 인해 IO가 제한됩니다.
- **VM의 캐시된 대역폭 사용 백분율**: 캐시된 최대 가상 머신 처리량 대비, 완료된 총 디스크 처리량으로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 VM의 캐시된 대역폭 한도로 인해 IO가 제한됩니다.
- **VM의 캐시되지 않은 IOPS 사용 백분율**: 캐시되지 않은 최대 가상 머신 IOPS 대비, 완료된 총 가상 머신 IOPS로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 VM의 캐시되지 않은 IOPS 한도로 인해 IO가 제한됩니다.
- **VM의 캐시되지 않은 대역폭 사용 백분율**: 프로비전된 최대 가상 머신 처리량 대비, 가상 머신에서 완료된 총 디스크 처리량으로 계산한 백분율입니다. 이 크기가 100%이면 애플리케이션 실행은 VM의 캐시되지 않은 대역폭 한도로 인해 IO가 제한됩니다.

## <a name="storage-io-metrics-example"></a>스토리지 IO 메트릭 예

이러한 새 스토리지 IO 사용률 메트릭을 통해 시스템에서 병목 현상이 발생한 부분을 디버그하는 방법을 살펴보겠습니다. 시스템 설정은 이전 예제와 동일하나, 이 번에는 연결된 OS 디스크가 *캐시되지* 않습니다.

**설정:**

- Standard_D8s_v3
  - 캐시된 IOPS: 16,000
  - 캐시되지 않은 IOPS: 12,800
- P30 OS 디스크
  - IOPS: 5,000
  - 호스트 캐싱: **사용 안 함**
- P30 데이터 디스크 2개 × 2
  - IOPS: 5,000
  - 호스트 캐싱: **읽기/쓰기**
- P30 데이터 디스크 2개 × 2
  - IOPS: 5,000
  - 호스트 캐싱: **사용 안 함**

IO 작업을 만드는 이 가상 머신과 디스크 조합에 대해 벤치마크 테스트를 실행해 보겠습니다. Azure에서 스토리지 IO를 벤치마크하는 방법은 [Azure Disk Storage에서 애플리케이션 벤치마크](disks-benchmarks.md)를 참조하세요. 벤치마크 도구에서 VM 및 디스크 조합이 22,800 IOPS를 달성할 수 있음을 확인할 수 있습니다.

![r=22.8k가 강조 표시된 fio 출력 스크린샷.](media/disks-metrics/utilization-metrics-example/fio-output.jpg)



Standard_D8s_v3는 총 28,600 IOPS를 달성할 수 있습니다. 이제 이 메트릭을 사용하여 상황을 파악하고 스토리지 IO 병목 상태를 식별해 보겠습니다. 왼쪽 창에서 **메트릭** 을 선택합니다.

![왼쪽 창에 강조 표시된 메트릭을 보여주는 스크린샷.](media/disks-metrics/utilization-metrics-example/metrics-menu.jpg)

먼저 **VM의 캐시된 IOPS 사용 백분율** 메트릭을 살펴보겠습니다.

![VM의 캐시된 IOPS 사용 백분율을 보여주는 스크린샷.](media/disks-metrics/utilization-metrics-example/vm-cached.jpg)

이 메트릭은 VM에서 캐시된 IOPS에 할당된 16000 IOPS의 61%가 사용되고 있음을 나타냅니다. 이 백분율은 100%가 아니기 때문에 캐시된 디스크에 스토리지 IO 병목 현상이 없음을 의미합니다. 이제 **VM의 캐시되지 않은 IOPS 사용 백분율** 메트릭을 살펴보겠습니다.

![VM의 캐시되지 않은 IOPS 사용 백분율을 보여주는 스크린샷.](media/disks-metrics/utilization-metrics-example/vm-uncached.jpg)

이 메트릭은 100%입니다. 즉, VM에서 캐시되지 않은 IOPS에 할당된 12,800 IOPS 전체가 사용 중임을 의미합니다. 이 문제를 해결할 수 있는 한 가지 방법은 추가 IO를 처리할 수 있는 더 큰 크기로 VM 크기를 변경하는 것입니다. 그러나 그 전에 먼저, 연결된 디스크를 살펴 얼마나 많은 IOPS가 있는지 확인해 보겠습니다. **OS 디스크 IOPS 사용 백분율** 을 확인하여 OS 디스크를 점검합니다.

![OS 디스크 IOPS 사용 백분율을 보여주는 스크린샷.](media/disks-metrics/utilization-metrics-example/os-disk.jpg)

이 메트릭은 이 P30 OS 디스크에 프로비전된 5,000 IOPS의 약 90%를 사용 중임을 나타냅니다. 이 백분율은 OS 디스크에 병목 현상이 없음을 의미합니다. 이제 **데이터 디스크 IOPS 사용 백분율** 을 확인하여 VM에 연결된 데이터 디스크를 점검해 보겠습니다.

![데이터 디스크 IOPS 사용 백분율을 보여주는 스크린샷.](media/disks-metrics/utilization-metrics-example/data-disks-no-splitting.jpg)

이 메트릭은 연결된 모든 디스크의 평균 IOPS 사용 백분율이 42% 정도임을 나타냅니다. 이 백분율은 디스크에서 사용한 IOPS를 기준으로 산출되며 호스트 캐시에서 서비스되는 것이 아닙니다. 이 매트릭에 *분할* 을 적용하고 LUN 값으로 나누어 이 메트릭을 더 구체적으로 살펴보겠습니다.

![분할이 적용된 데이터 디스크 IOPS 사용 백분율을 보여주는 스크린샷.](media/disks-metrics/utilization-metrics-example/data-disks-splitting.jpg)

이 메트릭은 LUN 3 및 2에 연결된 데이터 디스크가 프로비전된 IOPS의 약 85%를 사용하고 있음을 나타냅니다. 다음은 VM 및 디스크 아키텍처에서 IO가 어떻게 보이는지에 대한 다이어그램입니다.

![스토리지 IO 메트릭 예제 다이어그램.](media/disks-metrics/utilization-metrics-example/metrics-diagram.jpg)

## <a name="next-steps"></a>다음 단계

- [Azure Monitor 메트릭 개요](../azure-monitor/essentials/data-platform-metrics.md)
- [메트릭 집계 설명](../azure-monitor/essentials/metrics-aggregation-explained.md)
- [Azure Monitor를 사용하여 메트릭 경고 만들기, 보기 및 관리](../azure-monitor/alerts/alerts-metric.md)