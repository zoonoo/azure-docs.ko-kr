---
title: 데이터 흐름 매핑의 스키마 드리프트
description: 스키마 드리프트를 사용하여 Azure Data Factory에서 복원력 있는 데이터 흐름 빌드
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 04/15/2020
ms.openlocfilehash: 5b7fe9cf6c751bfb96dff8aa911172ae91a17653
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/02/2020
ms.locfileid: "84886638"
---
# <a name="schema-drift-in-mapping-data-flow"></a>데이터 흐름 매핑의 스키마 드리프트

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

스키마 드리프트는 소스가 메타 데이터를 자주 변경 하는 경우입니다. 필드, 열 및 형식을 즉석에서 추가, 제거 또는 변경할 수 있습니다. 스키마 드리프트를 처리 하지 않으면 데이터 흐름이 업스트림 데이터 원본 변경에 취약 해질 수 있습니다. 들어오는 열과 필드가 이러한 원본 이름에 연결 되기 때문에 들어오는 열과 필드가 변경 되 면 일반적인 ETL 패턴이 실패 합니다.

스키마 드리프트를 방지 하기 위해 데이터 흐름 도구에서 기능을 사용 하 여 데이터 엔지니어로 서 다음을 수행 하는 것이 중요 합니다.

* 변경 가능한 필드 이름, 데이터 형식, 값 및 크기를 포함 하는 원본 정의
* 하드 코드된 필드 및 값 대신 데이터 패턴을 사용할 수 있는 변환 매개 변수 정의
* 명명된 필드를 사용하는 대신 수신 필드와 일치하는 패턴을 이해하는 식 정의

Azure Data Factory은 데이터 흐름을 다시 컴파일할 필요 없이 일반 데이터 변환 논리를 작성할 수 있도록 실행에서 실행으로 변경 되는 유연한 스키마를 기본적으로 지원 합니다.

흐름 전체의 스키마 드리프트를 허용하도록 데이터 흐름의 아키텍처를 결정해야 합니다. 이렇게 하면 원본의 스키마 변경으로부터 보호할 수 있습니다. 그러나 데이터 흐름 전체에서 열 및 형식의 초기 바인딩이 손실 됩니다. Azure Data Factory은 스키마 드리프트 흐름을 런타임에 바인딩 흐름으로 처리 하므로 변환을 작성할 때 흐름 전체의 스키마 뷰에서 데이터베이스가 드리프트 열 이름을 사용할 수 없습니다.

이 비디오는 ADF에서 데이터 흐름의 스키마 드리프트 기능을 사용 하 여 쉽게 작성할 수 있는 복잡 한 솔루션 중 일부를 소개 합니다. 이 예제에서는 유연한 데이터베이스 스키마에 따라 재사용 가능한 패턴을 작성 합니다.

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RE4tyx7]

## <a name="schema-drift-in-source"></a>원본에서 스키마 드리프트

원본 정의에서 데이터 흐름으로 들어오는 열은 원본 프로젝션에 없는 경우 "데이터베이스가 드리프트"로 정의 됩니다. 원본 변환의 프로젝션 탭에서 원본 프로젝션을 볼 수 있습니다. 원본에 대 한 데이터 집합을 선택 하면 ADF가 자동으로 데이터 집합에서 스키마를 가져오고 해당 데이터 집합 스키마 정의에서 프로젝션을 만듭니다.

원본 변환에서 스키마 드리프트는 데이터 집합 스키마를 정의 하지 않은 읽기 열로 정의 됩니다. 스키마 드리프트를 사용 하도록 설정 하려면 원본 변환에서 **스키마 드리프트 허용** 을 선택 합니다.

![스키마 드리프트 원본](media/data-flow/schemadrift001.png "스키마 드리프트 원본")

스키마 드리프트를 사용 하도록 설정 하면 들어오는 모든 필드가 실행 중에 원본에서 읽어서 전체 흐름을 통해 싱크로 전달 됩니다. 기본적으로 *데이터베이스가 드리프트 열*이라고 하는 새로 검색 된 열은 모두 문자열 데이터 형식으로 도착 합니다. 데이터 흐름에서 데이터베이스가 드리프트 열의 데이터 형식을 자동으로 유추 하려면 원본 설정에서 **데이터베이스가 드리프트 열 형식 유추** 를 선택 합니다.

## <a name="schema-drift-in-sink"></a>싱크의 스키마 드리프트

싱크 변환에서 스키마 드리프트는 싱크 데이터 스키마에 정의 된 내용 위에 추가 열을 작성 하는 경우입니다. 스키마 드리프트를 사용 하도록 설정 하려면 싱크 변환에서 **스키마 드리프트 허용** 을 선택 합니다.

![스키마 드리프트 싱크](media/data-flow/schemadrift002.png "스키마 드리프트 싱크")

스키마 드리프트를 사용 하는 경우 매핑 탭에서 **자동 매핑** 슬라이더가 설정 되어 있는지 확인 합니다. 에서이 슬라이더를 사용 하면 들어오는 모든 열이 대상에 기록 됩니다. 그렇지 않으면 규칙 기반 매핑을 사용 하 여 데이터베이스가 드리프트 열을 써야 합니다.

![싱크 자동 매핑](media/data-flow/automap.png "싱크 자동 매핑")

## <a name="transforming-drifted-columns"></a>데이터베이스가 드리프트 열 변환

데이터 흐름에 데이터베이스가 드리프트 열이 있는 경우 다음 방법을 사용 하 여 변환에서 열에 액세스할 수 있습니다.

* `byPosition` `byName` 이름 또는 위치 번호로 열을 명시적으로 참조 하려면 및 식을 사용 합니다.
* 이름, 스트림, 위치 또는 형식의 조합에 대해 일치 하도록 파생 열 또는 집계 변환에 열 패턴을 추가 합니다.
* 패턴을 통해 데이터베이스가 드리프트 열을 열 별칭과 일치 시키려면 Select 또는 Sink 변환에 규칙 기반 매핑을 추가 합니다.

열 패턴을 구현 하는 방법에 대 한 자세한 내용은 [데이터 흐름 매핑의 열 패턴](concepts-data-flow-column-pattern.md)을 참조 하세요.

### <a name="map-drifted-columns-quick-action"></a>Map 데이터베이스가 드리프트 columns 빠른 작업

데이터베이스가 드리프트 열을 명시적으로 참조 하기 위해 데이터 미리 보기 빠른 작업을 통해 이러한 열에 대 한 매핑을 빠르게 생성할 수 있습니다. [디버그 모드가](concepts-data-flow-debug-mode.md) 설정 되 면 데이터 미리 보기 탭으로 이동 하 고 **새로 고침** 을 클릭 하 여 데이터 미리 보기를 가져옵니다. Data factory가 데이터베이스가 드리프트 열이 있는 것으로 감지 되 면 **데이터베이스가 드리프트 매핑** 을 클릭 하 고 스키마 뷰 다운스트림의 모든 데이터베이스가 드리프트 열을 참조할 수 있는 파생 열을 생성할 수 있습니다.

![지도 데이터베이스가 드리프트](media/data-flow/mapdrifted1.png "지도 데이터베이스가 드리프트")

생성 된 파생 열 변환에서 각 데이터베이스가 드리프트 열은 검색 된 이름 및 데이터 형식에 매핑됩니다. 위의 데이터 미리 보기에서 ' movieId ' 열은 정수로 검색 됩니다. **Map 데이터베이스가 드리프트** 을 클릭 하면 파생 열에 movieId가 정의 되 `toInteger(byName('movieId'))` 고 다운스트림 변환의 스키마 뷰에 포함 됩니다.

![지도 데이터베이스가 드리프트](media/data-flow/mapdrifted2.png "지도 데이터베이스가 드리프트")

## <a name="next-steps"></a>다음 단계
[데이터 흐름 식 언어](data-flow-expression-functions.md)에서 열 패턴에 대 한 추가 기능 및 "byName" 및 "byPosition"를 포함 하는 스키마 드리프트를 찾을 수 있습니다.
