---
title: Azure Site Recovery 서비스를 사용하여 Azure로 AWS VM 마이그레이션 | Microsoft Docs
description: 이 문서에서는 Azure Site Recovery를 사용하여 AWS(Amazon Web Services)에서 실행되는 Windows VM을 Azure로 마이그레이션하는 방법을 설명합니다.
services: site-recovery
author: rayne-wiselman
manager: carmonm
ms.service: site-recovery
ms.topic: tutorial
ms.date: 05/30/2019
ms.author: raynew
ms.custom: MVC
ms.openlocfilehash: 6d2b9c8dd8fb89e201cff5155b1dec0857204752
ms.sourcegitcommit: d89032fee8571a683d6584ea87997519f6b5abeb
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 05/30/2019
ms.locfileid: "66400060"
---
# <a name="migrate-amazon-web-services-aws-vms-to-azure"></a>AWS(Amazon Web Services)에서 Azure로 VM 마이그레이션

이 자습서에서는 Azure Site Recovery를 사용하여 AWS(Amazon Web Services) VM(가상 머신)을 Azure VM으로 마이그레이션하는 방법을 설명합니다. AWS EC2 인스턴스를 Azure로 마이그레이션할 때 VM은 온-프레미스의 물리적 컴퓨터처럼 처리됩니다. 이 자습서에서는 다음 방법에 대해 알아봅니다.

> [!div class="checklist"]
> * 필수 조건 확인
> * Azure 리소스 준비
> * 마이그레이션을 위해 AWS EC2 인스턴스 준비
> * 구성 서버 배포
> * VM에 대해 복제 활성화
> * 테스트 장애 조치(failover)를 통해 모든 것이 제대로 작동하는지 확인
> * Azure에 대한 일회성 장애 조치(failover) 실행

Azure 구독이 아직 없는 경우 시작하기 전에 [체험 계정](https://azure.microsoft.com/pricing/free-trial/)을 만듭니다.

## <a name="prerequisites"></a>필수 조건
- 마이그레이션할 VM이 지원되는 OS 버전을 실행하고 있는지 확인합니다. 지원되는 버전은 다음과 같습니다. 
  - Windows Server 2016 
  - Windows Server 2012 R2
  - Windows Server 2012 
  - 64비트 버전의 Windows Server 2008 R2 SP1 이상
  - Red Hat Enterprise Linux 6.4~6.10, 7.1~7.6(HVM 가상화된 인스턴스만 해당) *(RedHat PV 드라이버를 실행하는 인스턴스는 지원되지 않음)*
  - CentOS 6.4~6.10, 7.1~7.6(HVM 가상화된 인스턴스만 해당)
 
- 복제하려는 각 VM에 모바일 서비스가 설치되어야 합니다. 

    > [!IMPORTANT]
    > Site Recovery에서 VM에 대한 복제를 사용하도록 설정하면 이 서비스를 자동으로 설치합니다. 자동 설치가 되려면 Site Recovery가 VM에 액세스하는 데 사용할 EC2 인스턴스 계정을 준비해야 합니다. 도메인 또는 로컬 계정을 사용할 수 있습니다. 
    > - Linux VM의 경우 계정은 원본 Linux 서버의 루트여야 합니다. 
    > - Windows VM의 경우 도메인 계정을 사용하지 않으면 로컬 컴퓨터에서 원격 사용자 액세스 제어를 사용하지 않도록 설정합니다.
    >
    >      레지스트리의 **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System**에서 DWORD 항목 **LocalAccountTokenFilterPolicy**를 추가하고 값을 **1**로 설정합니다.

- Site Recovery 구성 서버로 사용할 수 있는 별도의 EC2 인스턴스. 이 인스턴스는 Windows Server 2012 R2를 실행해야 합니다.

## <a name="prepare-azure-resources"></a>Azure 리소스 준비

마이그레이션된 EC2 인스턴스가 사용할 몇 가지 리소스를 Azure에서 준비해야 합니다. 여기에는 저장소 계정, 자격 증명 모음, 가상 네트워크가 포함됩니다.

### <a name="create-a-storage-account"></a>저장소 계정 만들기

복제된 컴퓨터의 이미지는 Azure Storage에 유지됩니다. 온-프레미스에서 Azure로 장애 조치할 때 저장소에서 Azure VM이 만들어집니다.

1. [Azure Portal](https://portal.azure.com)의 왼쪽 메뉴에서 **리소스 만들기** > **Storage** > **Storage 계정**을 선택합니다.
2. 저장소 계정의 이름을 입력합니다. 이 자습서에서는 **awsmigrated2017**이라는 이름을 사용합니다. 이름은 다음과 같아야 합니다.
    - Azure에서 고유해야 함
    - 3자에서 24자 사이여야 함
    - 숫자와 소문자만 포함해야 함
3. **배포 모델**, **계정 종류**, **성능** 및 **보안 전송 필요**에 대한 기본값을 그대로 둡니다.
5. **복제**에서 **기본 RA-GRS**를 선택합니다.
6. 이 자습서에 대해 사용하려는 구독을 선택합니다.
7. **리소스 그룹**에 대해 **새로 만들기**를 선택합니다. 이 예에서는 리소스 그룹 이름에 **migrationRG**를 사용합니다.
8. **위치**로 **유럽 서부**를 선택합니다.
9. **만들기**를 선택하여 저장소 계정을 만듭니다.

### <a name="create-a-vault"></a>자격 증명 모음 만들기

1. [Azure Portal](https://portal.azure.com)에서 **모든 서비스**를 선택합니다. **Recovery Services 자격 증명 모음**을 검색한 후 선택합니다.
2. Azure Recovery Services 자격 증명 모음 페이지에서 **추가**를 선택합니다.
3. **이름**에 **myVault**를 입력합니다.
4. **구독**에 사용할 Azure 구독을 선택합니다.
4. **리소스 그룹**에서 **기존 항목 사용**을 선택한 후 **migrationRG**를 선택합니다.
5. **위치**로 **유럽 서부**를 선택합니다.
5. 대시보드에서 새 자격 증명 모음에 빠르게 액세스하려면 **대시보드에 고정**을 선택합니다.
7. 완료되면 **만들기**를 선택합니다.

새 자격 증명 모음을 보려면 이동 **대시보드** > **모든 리소스**로 이동합니다. 새 자격 증명 모음은 **Recovery Services 자격 증명 모음** 페이지에도 표시됩니다.

### <a name="set-up-an-azure-network"></a>Azure 네트워크를 설정합니다

마이그레이션(장애 조치(failover)) 후 만들어지는 Azure VM이 이 Azure 네트워크에 연결됩니다.

1. [Azure Portal](https://portal.azure.com)에서 **리소스 만들기** > **네트워킹** >
   **가상 네트워크**를 선택합니다.
3. **이름**에 **myMigrationNetwork**를 입력합니다.
4. **주소 공간**에 대한 기본값을 그대로 둡니다.
5. **구독**에 사용할 Azure 구독을 선택합니다.
6. **리소스 그룹**에서 **기존 항목 사용**을 선택한 후 **migrationRG**를 선택합니다.
7. **위치**로 **유럽 서부**를 선택합니다.
8. **서브넷**에서 **이름** 및 **IP 범위**의 기본값을 그대로 둡니다.
9. **서비스 엔드포인트** 옵션을 비활성화합니다.
10. 완료되면 **만들기**를 선택합니다.

## <a name="prepare-the-infrastructure"></a>인프라 준비

Azure Portal의 자격 증명 모음 페이지에 있는 **시작** 섹션에서 **Site Recovery**를 선택한 후 **인프라 준비**를 선택합니다. 다음 단계를 완료합니다.

### <a name="1-protection-goal"></a>1: 보호 목표

**보호 목표** 페이지에서 다음 값을 선택합니다.

|    |  |
|---------|-----------|
| 컴퓨터가 어디에 있나요? |**온-프레미스**를 선택합니다.|
| 컴퓨터를 복제할 위치를 선택하세요. |**Azure**를 선택합니다.|
| 컴퓨터가 가상화되어 있나요? |**가상화되지 않음/기타**를 선택합니다.|

완료되면 **확인**을 클릭하여 다음 섹션으로 이동합니다.

### <a name="2-select-deployment-planning"></a>2: 배포 계획 선택

**배포 계획을 완료하셨나요**에서 **나중에 수행**을 선택한 후 **확인**을 선택합니다.

### <a name="3-prepare-source"></a>3: 원본 준비

**원본 준비** 페이지에서 **+ 구성 서버**를 선택합니다.

1. Windows Server 2012 R2가 실행되는 EC2 인스턴스를 사용하여 구성 서버를 만들고 복구 자격 증명 모음에 등록합니다.
2. 구성 서버로 사용하는 EC2 인스턴스 VM에서 [서비스 URL](site-recovery-support-matrix-to-azure.md)에 액세스할 수 있도록 프록시를 구성합니다.
3. [Microsoft Azure Site Recovery 통합 설치](https://aka.ms/unifiedinstaller_wus)를 다운로드합니다. 로컬 컴퓨터에 다운로드한 후에 구성 서버로 사용할 VM에 복사해도 됩니다.
4. **다운로드** 단추를 선택하여 자격 증명 모음 등록 키를 다운로드합니다. 다운로드한 파일을 구성 서버로 사용할 VM에 복사합니다.
5. VM에서 Microsoft Azure Site Recovery 통합 설치용으로 다운로드한 설치 프로그램을 마우스 오른쪽 단추로 클릭한 후 **관리자 권한으로 실행**을 선택합니다.

    1. **시작하기 전에**에서 **구성 서버 및 프로세스 서버 설치**를 선택한 후 **다음**을 선택합니다.
    2. **타사 소프트웨어 라이선스**에서 **타사 소프트웨어 라이선스에 동의함**을 선택한 후 **다음**을 선택합니다.
    3. **등록**에서 **찾아보기**를 선택한 후 자격 증명 모음 등록 키 파일을 저장한 위치를 찾아 이동합니다. **다음**을 선택합니다.
    4. **인터넷 설정**에서 **프록시 서버 없이 Azure Site Recovery에 직접 연결**을 선택한 후 **다음**을 선택합니다.
    5. **필수 구성 요소 확인** 페이지에서 여러 항목에 대한 검사를 실행합니다. 완료되면 **다음**을 선택합니다.
    6. **MySQL 구성**에서 필요한 암호를 입력한 후 **다음**을 선택합니다.
    7. **환경 세부 정보**에서 **아니요**를 선택합니다. VMware 컴퓨터는 보호할 필요가 없습니다. 그다음에 **다음**을 선택합니다.
    8. **설치 위치**에서 **다음**을 선택하여 기본값을 적용합니다.
    9. **네트워크 선택**에서 **다음**을 선택하여 기본값을 적용합니다.
    10. **요약**에서 **설치**를 선택합니다.
    11. **설치 진행률**은 설치 프로세스에 대한 정보를 보여 줍니다. 완료되면 **다음**을 선택합니다. 다시 부팅하는 방법에 대한 메시지가 창에 표시됩니다. **확인**을 선택합니다. 그러면 구성 서버 연결 암호에 대한 메시지가 창에 표시됩니다. 암호를 클립보드에 복사하고 안전한 위치에 저장합니다.
6. VM에서 cspsconfigtool.exe를 실행하여 구성 서버에 대한 하나 이상의 관리 계정을 만듭니다. 관리 계정에 마이그레이션할 EC2 인스턴스에 대한 관리자 권한이 있는지 확인합니다.

구성 서버 설정을 마치면 포털로 돌아가서 **구성 서버** 에 대해 방금 만든 서버를 선택합니다. **확인**을 선택하여 3: 대상 준비로 이동합니다.

### <a name="4-prepare-target"></a>4: 대상 준비

이 섹션에서는 이 자습서 앞부분의 [Azure 리소스 준비](#prepare-azure-resources)에서 만든 리소스에 대한 정보를 입력합니다.

1. **구독**에서 [Azure 준비](tutorial-prepare-azure.md) 자습서에 사용한 Azure 구독을 선택합니다.
2. **Resource Manager** 를 배포 모델로 선택합니다.
3. Site Recovery가 호환되는 Azure 저장소 계정 및 네트워크가 하나 이상 있는지 확인합니다. 이는 이 자습서 앞부분의 [Azure 리소스 준비](#prepare-azure-resources)에서 만든 리소스여야 합니다.
4. 완료되면 **확인**을 선택합니다.

### <a name="5-prepare-replication-settings"></a>5: 복제 설정 준비

복제를 활성화하려면 먼저 복제 정책을 만들어야 합니다.

1. **복제 및 연결**을 선택합니다.
2. **이름**에 **myReplicationPolicy**를 입력합니다.
3. 나머지 기본 설정은 그대로 두고 **확인**을 클릭하여 정책을 만듭니다. 새로 만든 정책은 자동으로 구성 서버에 연결됩니다.

**인프라 준비**의 5개 섹션을 모두 완료했으면 **확인**을 선택합니다.

## <a name="enable-replication"></a>복제 사용

마이그레이션할 각 VM에 대해 복제를 사용하도록 설정합니다. 복제를 사용할 경우 Site Recovery에서 자동으로 모바일 서비스를 설치합니다.

1. [Azure 포털](https://portal.azure.com)로 이동합니다.
1. 자격 증명 모음에 대한 페이지의 **시작**에서 **사이트 복구**를 선택합니다.
2. **온-프레미스 머신 및 Azure VM의 경우**에서 **1단계: 애플리케이션 복제**를 선택합니다. 다음 정보로 마법사 페이지를 완성합니다. 완료될 때마다 각 페이지에서 **확인**을 선택합니다.
   - 1: 원본 구성

     |  |  |
     |-----|-----|
     | 원본: | **온-프레미스**를 선택합니다.|
     | 원본 위치:| 구성 서버 EC2 인스턴스의 이름을 입력합니다.|
     |컴퓨터 종류: | **물리적 컴퓨터**를 선택합니다.|
     | 프로세스 서버: | 드롭다운 목록에서 구성 서버를 선택합니다.|

   - 2: 대상 구성

     |  |  |
     |-----|-----|
     | 대상: | 기본값을 그대로 둡니다.|
     | 구독: | 사용해 온 구독을 선택합니다.|
     | 사후 장애 조치(failover) 리소스 그룹:| [Azure 리소스 준비](#prepare-azure-resources)에서 만든 리소스 그룹을 사용합니다.|
     | 사후 장애 조치(failover) 배포 모델: | **리소스 관리자**를 선택합니다.|
     | 저장소 계정: | [Azure 리소스 준비](#prepare-azure-resources)에서 만든 저장소 계정을 선택합니다.|
     | Azure 네트워크: | **선택한 컴퓨터에 대해 지금 구성합니다**를 선택합니다.|
     | 사후 장애 조치(failover) Azure 네트워크: | [Azure 리소스 준비](#prepare-azure-resources)에서 만든 네트워크를 선택합니다.|
     | 서브넷: | 드롭다운 목록에서 **기본값**을 선택합니다.|

   - 3: 물리적 머신 선택

     **물리적 컴퓨터**를 선택한 다음, 마이그레이션할 EC2 인스턴스의 **이름**, **IP 주소** 및 **OS 유형**을 입력합니다. **확인**을 선택합니다.

   - 4: 속성 구성

     구성 서버에 대해 만든 계정을 선택한 후 **확인**을 선택합니다.

   - 5: 복제 설정 구성

     드롭다운 목록에서 복제 정책으로 **myReplicationPolicy**가 선택되었는지 확인한 후 **확인**을 선택합니다.

3. 마법사가 완료되면 **복제 사용**을 선택합니다.

**보호 사용** 작업의 진행률을 추적하려면 **모니터링 및 보고서** > **작업** > **Site Recovery 작업**으로 이동합니다. **보호 완료** 작업이 실행된 후에는 컴퓨터가 장애 조치(failover)를 수행할 준비가 되어 있습니다.        

VM에 대해 복제를 사용하도록 설정하면 변경 내용이 적용되어 포털에 표시되는 데 15분 이상 걸릴 수 있습니다.

## <a name="run-a-test-failover"></a>테스트 장애 조치(failover) 실행

테스트 장애 조치(failover)를 실행하면 다음과 같은 이벤트가 발생합니다.

- 필수 구성 요소 확인은 장애 조치(failover)에 필요한 모든 조건이 충족되었는지 확인하기 위해 실행합니다.
- 장애 조치(failover)는 데이터를 처리하며 이 데이터에서 Azure VM이 만들어질 수 있습니다. 최신 복구 지점을 선택하는 경우 해당 데이터에서 복구 지점이 만들어집니다.
- 이전 단계에서 처리된 데이터를 사용하여 Azure VM이 만들어집니다.

포털에서 테스트 장애 조치(failover)를 실행합니다.

1. 자격 증명 모음에 대한 페이지에서 **보호된 항목** > **복제된 항목**으로 이동합니다. VM을 선택한 후 **테스트 장애 조치(failover)** 를 선택합니다.
2. 장애 조치(failover)에 사용할 복구 지점을 선택합니다.
    - **가장 최근에 처리됨**: VM을 Site Recovery에서 처리된 최신 복구 지점으로 장애 조치(failover)합니다. 타임스탬프가 표시됩니다. 이 옵션을 사용하면 데이터를 처리하는 데 시간을 소비하지 않으므로 낮은 RTO(복구 시간 목표)가 제공됩니다.
    - **최신 앱 일치**: 모든 VM을 최신 앱 일치 복구 지점으로 장애 조치합니다. 타임스탬프가 표시됩니다.
    - **사용자 지정**: 복구 지점을 선택합니다.

3. **테스트 장애 조치(Failover)** 에서 장애 조치(Failover)가 발생한 후에 Azure VM이 연결될 대상 Azure 네트워크를 선택합니다. 이는 [Azure 리소스 준비](#prepare-azure-resources)에서 만든 네트워크여야 합니다.
4. **확인**을 선택하여 장애 조치(failover)를 시작합니다. 진행률을 추적하려면 VM을 선택하여 해당 속성을 봅니다. 또는 자격 증명 모음의 페이지에서 **테스트 장애 조치(failover)** 작업을 선택할 수 있습니다. 그러려면 **모니터링 및 보고서** > **작업** >  **Site Recovery 작업**을 선택합니다.
5. 장애 조치(failover)가 완료되면 Azure Portal에 Azure VM 복제본이 표시됩니다. VM을 보려면 **Virtual Machines**를 선택합니다. VM의 크기가 적당하고, VM이 올바른 네트워크에 연결되어 있으며 실행 중인지 확인합니다.
6. 이제 Azure에서 복제된 VM에에 연결할 수 있습니다.
7. 테스트 장애 조치(failover) 중에 만든 Azure VM을 삭제하려면 복제된 항목 또는 복구 계획에서 **테스트 장애 조치(failover) 정리**를 선택합니다. **참고**에서 테스트 장애 조치와 관련된 모든 관측 내용을 기록하고 저장합니다.

일부 시나리오에서는 장애 조치에 추가 처리 과정이 필요합니다. 처리가 완료되는 데 8~10분이 걸립니다.

## <a name="migrate-to-azure"></a>Azure로 마이그레이션

Azure VM에 마이그레이션할 EC2 인스턴스에 대해 실제 장애 조치(failover)를 실행합니다.

1. **보호된 항목** > **복제된 항목**에서 AWS 인스턴스를 선택한 후 **장애 조치(Failover)** 를 선택합니다.
2. **장애 조치(Failover)** 에서 장애 조치할 **복구 지점**을 선택합니다. 최근 복구 지점을 선택하고 장애 조치(failover)를 시작합니다. **작업** 페이지에서 장애 조치 진행 상황 확인을 수행할 수 있습니다.
1. VM이 **복제된 항목**에 표시되는지 확인합니다.
2. 각 VM을 마우스 오른쪽 단추로 클릭한 후 **마이그레이션 완료**를 선택합니다. 다음을 수행합니다.

   - 그러면 마이그레이션 프로세스가 완료되고, AWS VM에 대한 복제가 중지되고, VM에 대한 Site Recovery 청구가 중지됩니다.
   - 이 단계는 복제 데이터를 정리합니다. 마이그레이션된 VM을 삭제하지 않습니다. 

     ![마이그레이션 완료](./media/migrate-tutorial-aws-azure/complete-migration.png)

> [!WARNING]
> *진행 중인 장애 조치(failover)는 취소하지 마세요*. 장애 조치(failover)를 시작하기 전에 VM 복제가 중지됩니다. 진행 중인 장애 조치(failover)를 취소하면 장애 조치(failover)가 중지되지만 VM은 다시 복제되지 않습니다.  


## <a name="next-steps"></a>다음 단계

이 문서에서는 Azure VM에 AWS EC2 인스턴스를 마이그레이션하는 방법을 배웠습니다. Azure VM에 대해 자세히 알아보려면 계속해서 Windows VM 자습서를 검토하세요.

> [!div class="nextstepaction"]
> [Azure Windows 가상 머신 자습서](../virtual-machines/windows/tutorial-manage-vm.md)
