---
title: Azure Monitor를 사용 하 여 Azure Cosmos DB에 대 한 경고 만들기
description: Azure Monitor를 사용 하 여 Azure Cosmos DB에 대 한 경고를 설정 하는 방법을 알아봅니다.
author: SnehaGunda
ms.author: sngun
ms.service: cosmos-db
ms.subservice: cosmosdb-sql
ms.devlang: dotnet
ms.topic: how-to
ms.date: 07/16/2020
ms.openlocfilehash: 1042638dc622e6675c997bc6db8df1d072824816
ms.sourcegitcommit: 3bdeb546890a740384a8ef383cf915e84bd7e91e
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/30/2020
ms.locfileid: "93099915"
---
# <a name="create-alerts-for-azure-cosmos-db-using-azure-monitor"></a>Azure Monitor를 사용 하 여 Azure Cosmos DB에 대 한 경고 만들기
[!INCLUDE[appliesto-all-apis](includes/appliesto-all-apis.md)]

경고는 Azure Cosmos DB 리소스의 가용성 및 응답성을 모니터링 하도록 되풀이 테스트를 설정 하는 데 사용 됩니다. 경고는 전자 메일 형식으로 알림을 보내거나, 메트릭 중 하나가 임계값에 도달 하거나 활동 로그에 특정 이벤트가 기록 된 경우 Azure 함수를 실행할 수 있습니다.

Azure Cosmos 계정의 메트릭 또는 활동 로그 이벤트를 기반으로 경고를 받을 수 있습니다.

* **메트릭** -지정 된 메트릭의 값이 사용자가 할당 한 임계값을 초과 하면 경고가 트리거됩니다. 예를 들어 사용 된 총 요청 단위가 1000 r u/초를 초과 하는 경우 이 경고는 조건이 처음 충족 될 때와 그 이후에 조건이 더 이상 충족 되지 않을 때 모두 트리거됩니다. Azure Cosmos DB에서 사용할 수 있는 여러 메트릭에 대해서는 [모니터링 데이터 참조](monitor-cosmos-db-reference.md#metrics) 문서를 참조 하세요.

* **활동 로그 이벤트** –이 경고는 특정 이벤트가 발생할 때 트리거됩니다. 예를 들어 Azure Cosmos 계정의 키에 액세스 하거나 새로 고칠 때입니다.

Azure Cosmos DB 창이 나 Azure Portal의 Azure Monitor 서비스에서 경고를 설정할 수 있습니다. 두 인터페이스 모두 동일한 옵션을 제공 합니다. 이 문서에서는 Azure Monitor를 사용 하 여 Azure Cosmos DB에 대 한 경고를 설정 하는 방법을 보여 줍니다.

## <a name="create-an-alert-rule"></a>경고 규칙 만들기

이 섹션에서는 요청 빈도가 제한 될 때 수신 되는 HTTP 상태 코드 429을 수신할 때 경고를 만드는 방법을 보여 줍니다. 예를 들어 100 이상의 요금 제한 요청이 있는 경우 경고를 받을 수 있습니다. 이 문서에서는 HTTP 상태 코드를 사용 하 여 이러한 시나리오에 대 한 경고를 구성 하는 방법을 보여 줍니다. 이와 유사한 단계를 사용 하 여 다른 유형의 경고도 구성할 수도 있습니다. 요구 사항에 따라 다른 조건을 선택 하기만 하면 됩니다.

1. Azure Portal에 로그인 [합니다.](https://portal.azure.com/)

1. 왼쪽 탐색 모음에서 **모니터** 를 선택 하 고 **경고** 를 선택 합니다.

1. 새 경고 규칙 단추를 선택 하 여 경고 규칙 만들기 창을 엽니다.  

1. **범위** 섹션을 입력 합니다.

   * **리소스 선택** 창을 열고 다음을 구성 합니다.

   * **구독** 이름을 선택 합니다.

   * **리소스 종류** 에 대 한 **Azure Cosmos DB 계정을** 선택 합니다.

   * Azure Cosmos 계정의 **위치** 입니다.

   * 세부 정보를 입력 한 후에는 선택한 범위의 Azure Cosmos 계정 목록이 표시 됩니다. 경고를 구성 하려는 항목을 선택 하 고 **완료** 를 선택 합니다.

1. **조건** 섹션을 입력 합니다.

   * **조건 선택** 창을 열어 **신호 논리 구성** 페이지를 열고 다음을 구성 합니다.

   * 신호를 선택합니다. **신호 유형은** **메트릭** 또는 **활동 로그가** 될 수 있습니다. 이 시나리오에 대 한 **메트릭** 을 선택 합니다. 전체 요청 단위 메트릭에 대해 비율 제한 문제가 있는 경우 경고를 표시 하려고 합니다.

   * **모니터 서비스** 에 대해 **모두** 선택

   * **신호 이름을** 선택 합니다. HTTP 상태 코드에 대 한 경고를 가져오려면 **Total Request unit** 신호를 선택 합니다.

   * 다음 탭에서 경고를 트리거하는 논리를 정의 하 고 차트를 사용 하 여 Azure Cosmos 계정의 추세를 볼 수 있습니다. **총 요청 단위** 메트릭은 차원을 지원 합니다. 이러한 차원을 사용 하 여 메트릭을 필터링 할 수 있습니다. 차원이 선택 되지 않은 경우이 값은 무시 됩니다.

   * **차원 이름** 으로 **StatusCode** 를 선택 합니다. **사용자 지정 값 추가** 를 선택 하 고 상태 코드를 429으로 설정 합니다.

   * **경고 논리** 에서 **임계값** 을 **고정** 으로 설정 합니다. 정적 임계값은 사용자 정의 임계값을 사용 하 여 규칙을 평가 하는 반면 동적 임계값은 기본 기계 학습 알고리즘을 사용 하 여 메트릭 동작 패턴을 지속적으로 학습 하 고 임계값을 자동으로 계산 합니다.

   * **연산자** 를 **보다 큼** 으로, **집계 유형** 을 **Total** 로, **임계값** 을 **100** 으로 설정 합니다. 이 논리를 사용 하는 경우 클라이언트가 429 상태 코드를 포함 하는 100 이상의 요청을 볼 경우 경고가 트리거됩니다. 또한 요구 사항에 따라 집계 유형, 집계 세분성 및 평가 빈도를 구성할 수 있습니다.

   * 양식을 채운 후 **완료** 를 선택 합니다. 다음 스크린샷은 경고 논리의 세부 정보를 보여 줍니다.

     :::image type="content" source="./media/create-alerts/configure-alert-logic.png" alt-text="Rate 제한/429 요청에 대 한 경고를 받도록 논리 구성":::

1. **작업 그룹** 섹션을 작성 합니다.

   * **규칙 만들기** 창에서 기존 작업 그룹을 선택 하거나 새 작업 그룹을 만듭니다. 작업 그룹을 사용 하면 경고 조건이 발생할 때 수행할 작업을 정의할 수 있습니다. 이 예에서는 경고가 트리거될 때 전자 메일 알림을 받을 새 작업 그룹을 만듭니다. **작업 그룹 추가** 창을 열고 다음 세부 정보를 입력 합니다.

   * **작업 그룹 이름** -작업 그룹 이름은 리소스 그룹 내에서 고유 해야 합니다.

   * **약식 이름** -작업 그룹의 짧은 이름입니다 .이 값은 전자 메일 및 SMS 알림에 포함 되어 알림 원본 이었던 작업 그룹을 식별 합니다.

   * 이 작업 그룹을 만들 구독 및 리소스 그룹을 선택 합니다.  

   * 작업 이름을 입력 하 고 **메일/SMS 메시지/푸시/음성** 을 **작업 유형** 으로 선택 합니다. 다음 스크린샷은 작업 유형에 대 한 세부 정보를 보여줍니다.

     :::image type="content" source="./media/create-alerts/configure-alert-action-type.png" alt-text="Rate 제한/429 요청에 대 한 경고를 받도록 논리 구성":::

1. **경고 규칙 세부 정보** 섹션을 작성 합니다.

   * 규칙의 이름을 정의 하 고, 선택적인 설명, 경고의 심각도를 제공 하 고, 규칙을 만들 때 규칙을 사용할지 여부를 선택한 다음, **규칙 경고 만들기** 를 선택 하 여 메트릭 규칙 경고를 만듭니다.

경고를 만든 후 10 분 내에 활성화 됩니다.

## <a name="common-alerting-scenarios"></a>일반적인 경고 시나리오

다음은 경고를 사용할 수 있는 몇 가지 시나리오입니다.

* Azure Cosmos 계정의 키가 업데이트 되는 경우
* 컨테이너, 데이터베이스 또는 영역의 데이터 또는 인덱스 사용이 특정 바이트 수를 초과 하는 경우
* 정규화 된 r u/초 소비가 특정 비율 보다 큰 경우 정규화 된 과도 소비 메트릭은 복제본 집합 내의 최대 처리량 사용률을 제공 합니다. 자세한 내용은 [표준화 된/s를 모니터링 하는 방법](monitor-normalized-request-units.md) 문서를 참조 하세요.  
* 영역을 추가 하거나 제거 하거나 오프 라인으로 전환 하는 경우
* 데이터베이스나 컨테이너를 만들거나 삭제 하거나 업데이트 하는 경우
* 데이터베이스 또는 컨테이너의 처리량이 변경 된 경우

## <a name="next-steps"></a>다음 단계

* Azure Cosmos container에서 [정규화 된 r u/s 메트릭을 모니터링](monitor-normalized-request-units.md) 하는 방법입니다.
* Azure Cosmos DB에서 작업의 [처리량 또는 요청 단위 사용을 모니터링](monitor-request-unit-usage.md) 하는 방법입니다.