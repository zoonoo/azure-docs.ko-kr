---
title: Azure 센티널의 구하기 기능 | Microsoft Docs
description: 이 문서에서는 Azure 센티널 구하기 기능을 사용 하는 방법을 설명 합니다.
services: sentinel
documentationcenter: na
author: yelevin
manager: rkarlin
editor: ''
ms.assetid: 6aa9dd27-6506-49c5-8e97-cc1aebecee87
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.devlang: na
ms.topic: conceptual
ms.custom: mvc
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/10/2019
ms.author: yelevin
ms.openlocfilehash: 52af688917aa531d125f83844df29a988ed7cb7e
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/28/2020
ms.locfileid: "81686627"
---
# <a name="hunt-for-threats-with-azure-sentinel"></a>Azure 센티널로 위협 구하기

보안 위협에 대 한 사전 예방을 원하는 조사 기 경우 Azure는 강력한 검색 검색 및 쿼리 도구를 통해 조직의 데이터 원본에서 보안 위협을 찾아냅니다. 그러나 시스템 및 보안 어플라이언스는 의미 있는 이벤트를 구문 분석 하 고 필터링 하기 어려울 수 있는 데이터의 산을 생성 합니다. 보안 분석가가 보안 앱에서 검색 되지 않은 새 변칙을 사전에 확인 하는 데 도움이 되도록 Azure 센티널의 기본 제공 검색 쿼리는 네트워크에 이미 있는 데이터의 문제를 찾기 위한 적절 한 질문을 안내 합니다. 

예를 들어 기본 제공 쿼리 중 하나는 인프라에서 실행 되는 가장 일반적인 프로세스에 대 한 데이터를 제공 하는 것입니다. 실행 될 때마다 경고를 표시 하지 않는 것이 좋습니다. 그렇지 않은 경우에는 의도 하지 않은 조건이 있는지 확인 하기 위해 쿼리를 살펴볼 수 있습니다. 



Azure 센티널 구하기를 사용 하면 다음과 같은 기능을 활용할 수 있습니다.

- 기본 제공 쿼리: 시작 하기 위해 시작 페이지는 미리 로드 된 쿼리 예제를 시작 하 여 테이블 및 쿼리 언어를 친숙 하 게 만들 수 있도록 설계 되었습니다. 이러한 기본 제공 검색 쿼리는 지속적으로 Microsoft 보안 연구원에 의해 개발 되 고, 새 쿼리를 추가 하 고, 기존 쿼리를 미세 조정 하 여 새 검색을 찾고 새 공격의 시작을 위한 검색을 시작할 위치를 파악할 수 있는 진입점을 제공 합니다. 

- IntelliSense를 사용 하는 강력한 쿼리 언어: 다음 수준으로 이동 하는 데 필요한 유연성을 제공 하는 쿼리 언어 위에 빌드됩니다.

- 사용자 고유의 책갈피 만들기: 검색 프로세스를 진행 하는 동안 비정상적인 또는 의심 스러운 것으로 보이는 일치 항목, 대시보드 또는 작업을 통해 제공 될 수 있습니다. 이러한 항목을 표시 하기 위해 나중에 다시 돌아올 수 있도록 책갈피 기능을 사용 합니다. 책갈피를 사용 하 여 나중에 조사를 위해 인시던트를 만드는 데 사용할 항목을 저장할 수 있습니다. 책갈피에 대 한 자세한 내용은 [사냥에서 책갈피 사용](hunting.md)을 참조 하세요.
- 노트북을 사용 하 여 조사 자동화: 전자 필기장은 조사 및 사냥 단계를 안내 하기 위해 빌드할 수 있는 단계별 플레이 북과 비슷합니다.  노트북은 조직의 다른 사용자와 공유할 수 있는 재사용 가능한 플레이 북의 모든 구하기 단계를 캡슐화 합니다. 
- 저장 된 데이터 쿼리: 쿼리를 위해 테이블에서 데이터에 액세스할 수 있습니다. 예를 들어 프로세스 만들기, DNS 이벤트 및 기타 많은 이벤트 유형을 쿼리할 수 있습니다.

- 커뮤니티에 대 한 링크: 더 큰 커뮤니티의 기능을 활용 하 여 추가 쿼리 및 데이터 원본을 찾을 수 있습니다.
 
## <a name="get-started-hunting"></a>구하기 시작

1. Azure 센티널 포털에서 **구하기**를 클릭 합니다.
  ![Azure 센티널에서 구하기 시작](media/tutorial-hunting/hunting-start.png)

2. **구하기** 페이지를 열면 모든 구하기 쿼리가 단일 테이블에 표시 됩니다. 이 표에는 Microsoft의 보안 분석가 팀에서 작성 하거나 수정한 모든 추가 쿼리를 비롯 한 모든 쿼리가 나열 됩니다. 각 쿼리는 시스템적인에 대 한 설명 및 실행 되는 데이터의 종류를 제공 합니다. 이러한 템플릿은 다양 한 전략에 따라 그룹화 됩니다. 오른쪽의 아이콘은 초기 액세스, 지 속성, exfiltration 등의 위협 유형을 분류 합니다. 모든 필드를 사용 하 여 이러한 구하기 쿼리 템플릿을 필터링 할 수 있습니다. 모든 쿼리를 즐겨찾기에 저장할 수 있습니다. 즐겨찾기에 쿼리를 저장 하면 자동으로 **사냥** 페이지가 액세스 될 때마다 쿼리가 자동으로 실행 됩니다. 사용자 고유의 구하기 쿼리를 만들거나 기존 구하기 쿼리 템플릿을 복제 하 고 사용자 지정할 수 있습니다. 
 
2. 구하기 쿼리 세부 정보 페이지에서 **쿼리 실행** 을 클릭 하 여 사냥 페이지를 떠나지 않고 쿼리를 실행 합니다.  일치 하는 항목 수는 테이블에 표시 됩니다. 구하기 쿼리 및 일치 항목의 목록을 검토 합니다. 일치 항목을 연결 하는 kill 체인의 단계를 확인 합니다.

3. 쿼리 세부 정보 창에서 기본 쿼리를 빠르게 검토 하거나 **쿼리 결과 보기** 를 클릭 하 여 Log Analytics에서 쿼리를 엽니다. 아래쪽에서 쿼리와 일치 하는 항목을 검토 합니다.

4.    행을 클릭 하 고 **책갈피 추가** 를 선택 하 여 조사할 행을 추가 합니다. 의심 스러운 모든 항목에 대해이 작업을 수행할 수 있습니다. 

5. 그런 **다음 주 검색** 페이지로 돌아가 **책갈피** 탭을 클릭 하 여 의심 스러운 활동을 모두 표시 합니다. 

6. 책갈피를 선택 하 고 **조사** 를 클릭 하 여 조사 환경을 엽니다. 책갈피를 필터링 할 수 있습니다. 예를 들어 캠페인을 조사 하는 경우 캠페인에 대 한 태그를 만든 다음 캠페인에 따라 모든 책갈피를 필터링 할 수 있습니다.

1. 가능한 공격에 대 한 높은 가치의 정보를 제공 하는 구하기 쿼리를 발견 한 후에는 쿼리를 기반으로 사용자 지정 검색 규칙을 만들고 해당 정보를 보안 인시던트 응답자에 대 한 경고로 표시할 수 있습니다.

 

## <a name="query-language"></a>쿼리 언어 

Azure 센티널의 구하기는 Kusto 쿼리 언어를 기반으로 합니다. 쿼리 언어 및 지원 되는 연산자에 대 한 자세한 내용은 [쿼리 언어 참조](/azure/azure-monitor/log-query/get-started-queries)를 참조 하세요.

## <a name="public-hunting-query-github-repository"></a>공용 구하기 쿼리 GitHub 리포지토리

[구하기 쿼리 리포지토리](https://github.com/Azure/Orion)를 확인 합니다. 고객이 공유 하는 예제 쿼리를 참여 하 고 사용 합니다.

 

## <a name="sample-query"></a>샘플 쿼리

일반적인 쿼리는 테이블 이름으로 시작하며 그 뒤에 로 구분된 일련의 \|연산자가 있습니다.

위의 예제에서 테이블 이름 SecurityEvent로 시작 하 고 필요에 따라 파이프 된 요소를 추가 합니다.

1. 이전 7 일 동안의 레코드만을 검토 하는 시간 필터를 정의 합니다.

2. 이벤트 ID 4688만 표시 하도록 쿼리에 필터를 추가 합니다.

3. 명령줄의 쿼리에 필터를 추가 하 여 cscript.exe 인스턴스만 포함 합니다.

4. 탐색 하는 데 관심이 있는 열만 프로젝션 하 고 결과를 1000으로 제한 한 다음 **쿼리 실행**을 클릭 합니다.
5. 녹색 삼각형을 클릭 하 고 쿼리를 실행 합니다. 쿼리를 테스트 하 고 실행 하 여 비정상적인 동작을 찾을 수 있습니다.

## <a name="useful-operators"></a>유용한 연산자

쿼리 언어는 강력 하 고 사용할 수 있는 연산자가 많지만 여기에는 몇 가지 유용한 연산자가 나와 있습니다.

**where** -조건자를 충족 하는 행의 하위 집합에 대 한 테이블을 필터링 합니다.

**요약** -입력 테이블의 내용을 집계 하는 테이블을 생성 합니다.

각 테이블의 지정 된 열 값을 일치 시켜 새 테이블을 구성 하려면 두 테이블의 행을 **조인** 병합 합니다.

**count** -입력 레코드 집합의 레코드 수를 반환 합니다.

**top** -지정 된 열을 기준으로 정렬 된 처음 N 개 레코드를 반환 합니다.

**limit** -지정 된 행 수까지 반환 합니다.

**프로젝트** -포함 하거나, 이름을 바꾸거나, 삭제할 열을 선택 하 고 새 계산 열을 삽입 합니다.

**확장** -계산 된 열을 만들어 결과 집합에 추가 합니다.

**makeset** -Expr이 그룹에서 사용 하는 고유 값 집합의 동적 (JSON) 배열을 반환 합니다.

**찾기** -테이블 집합에서 조건자와 일치 하는 행을 찾습니다.

## <a name="save-a-query"></a>쿼리 저장

쿼리를 만들거나 수정 하 고 사용자의 쿼리로 저장 하거나 동일한 테 넌 트에 있는 사용자와 공유할 수 있습니다.

   ![쿼리 저장](./media/tutorial-hunting/save-query.png)

새 구하기 쿼리를 만듭니다.

1. **새 쿼리** 를 클릭 하 고 **저장**을 선택 합니다.
2. 모든 빈 필드를 입력 하 고 **저장**을 선택 합니다.

   ![새 쿼리](./media/tutorial-hunting/new-query.png)

기존 구하기 쿼리를 복제 하 고 수정 합니다.

1. 수정 하려는 테이블에서 구하기 쿼리를 선택 합니다.
2. 수정 하려는 쿼리 줄에서 줄임표 (...)를 선택 하 고 **쿼리 복제**를 선택 합니다.

   ![쿼리 복제](./media/tutorial-hunting/clone-query.png)
 

3. 쿼리를 수정 하 고 **만들기**를 선택 합니다.

   ![사용자 지정 쿼리](./media/tutorial-hunting/custom-query.png)

## <a name="next-steps"></a>다음 단계
이 문서에서는 Azure 센티널에서 구하기 조사를 실행 하는 방법을 알아보았습니다. Azure Sentinel에 대한 자세한 내용은 다음 문서를 참조하세요.


- [노트북을 사용 하 여 자동화 된 구하기 캠페인 실행](notebooks.md)
- [책갈피를 사용 하 여 검색할 때 관심 있는 정보 저장](bookmarks.md)
