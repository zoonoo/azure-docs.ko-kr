---
title: SQL 취약성 평가
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: SQL 취약성 평가를 구성하고 Azure SQL Database, Azure SQL Managed Instance, Azure Synapse Analytics의 평가 보고서를 해석하는 방법에 대해 알아봅니다.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 02/11/2021
tags: azure-synapse
ms.openlocfilehash: 1719c5a7112ee32f86d0593d274a59638cf81a0e
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/29/2021
ms.locfileid: "100376646"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>SQL 취약성 평가는 데이터베이스 취약성을 식별하는 데 유용합니다.
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

SQL 취약성 평가는 데이터베이스의 잠재적인 취약성을 검색, 추적하여 수정할 수 있는 간편하게 구성할 수 있는 서비스입니다. 이 도구를 사용하여 데이터베이스 보안을 사전에 강화하세요.

취약성 평가는 고급 SQL 보안 기능용 통합 패키지인 [Azure Defender for SQL](azure-defender-for-sql.md) 제품에 포함되어 있습니다. Azure Defender for SQL 중앙 포털을 통해 취약성 평가에 액세스하고 관리할 수 있습니다.

> [!NOTE]
> 취약성 평가는 Azure SQL Database, Azure SQL Managed Instance, Azure Synapse Analytics에서 지원됩니다. Azure SQL Database, Azure SQL Managed Instance, Azure Synapse Analytics의 데이터베이스는 이 문서의 나머지 부분에서 전체적으로 데이터베이스라고 지칭되며, 서버는 Azure SQL Database 및 Azure Synapse의 데이터베이스를 호스트하는 [서버](logical-servers.md)를 지칭합니다.

## <a name="what-is-sql-vulnerability-assessment"></a>SQL 취약성 평가란?

SQL 취약성 평가는 보안 상태를 살펴볼 수 있게 하는 서비스입니다. 취약성 평가에는 보안 문제를 해결하고 데이터베이스 보안을 강화하는 실행 가능한 단계가 포함됩니다. 이를 통해 변경 내용을 추적하기 어려운 데이터베이스 환경을 모니터링하고 SQL 보안 상태를 개선할 수 있습니다.

취약성 평가는 Azure SQL Database 서비스에 기본 제공되는 검사 서비스입니다. 이 서비스는 보안 취약성에 플래그를 지정하는 규칙의 기술 자료를 채택합니다. 잘못된 구성, 과도한 권한, 보호되지 않는 민감한 데이터 등 모범 사례의 편차를 강조합니다.

규칙은 Microsoft의 모범 사례를 기반으로 하고 데이터베이스와 중요한 데이터에 가장 큰 위험을 끼치는 보안 문제에 초점을 맞춥니다. 이러한 규칙은 데이터베이스 레벨 문제 및 서버 레벨 보안 문제(예: 서버 방화벽 설정 및 서버 레벨 권한)에 모두 적용됩니다.

검색 결과에는 각 문제를 해결하는 실행 가능한 단계가 포함되며 해당하는 경우 사용자 지정된 재구성 스크립트가 제공됩니다. 다음 사항에 대해 허용 가능한 기준을 설정하여 사용자 환경에 대한 평가 보고서를 사용자 지정할 수 있습니다.

- 권한 구성
- 기능 구성
- 데이터베이스 설정

## <a name="configure-vulnerability-assessment"></a>취약성 평가 구성

취약성 평가를 구성하려면 다음 단계를 수행합니다.

1. [Azure Portal](https://portal.azure.com)에서 Azure SQL Database, SQL Managed Instance Database 또는 Azure Synapse의 특정 리소스를 엽니다.

1. **보안** 제목 아래에서 **Security Center** 를 선택합니다.

1. 링크에서 **구성** 을 선택하여 전체 서버 또는 관리되는 인스턴스에 대한 Azure Defender for SQL 설정 창을 엽니다.

    :::image type="content" source="media/sql-vulnerability-assessment/opening-sql-configuration.png" alt-text="Defender for SQL 구성 열기":::

    > [!NOTE]
    > SQL 취약성 평가를 위해서는 검사를 실행할 수 있는 **Azure Defender for SQL** 플랜이 필요합니다. Azure Defender for SQL 사용 방법에 대한 자세한 내용은 [Azure Defender for SQL](azure-defender-for-sql.md)을 참조하세요.

1. **서버 설정** 페이지에서 SQL 설정에 대한 Azure Defender를 정의합니다.

    :::image type="content" source="media/sql-vulnerability-assessment/sql-vulnerability-scan-settings.png" alt-text="SQL 취약성 평가 검사 구성":::

    1. 먼저 서버의 모든 데이터베이스 또는 관리되는 인스턴스에 대한 검사 결과를 저장할 스토리지 계정을 구성합니다. 스토리지 계정에 대한 자세한 내용은 [Azure Storage 계정 정보](../../storage/common/storage-account-create.md)를 참조하세요.

        > [!TIP]
        > 방화벽 및 VNet의 뒤로 취약성 평가 검사를 저장하는 방법에 대한 자세한 내용은 [방화벽 및 VNet 뒤로 액세스할 수 있는 스토리지 계정에 취약성 평가 검사 결과 저장](sql-database-vulnerability-assessment-storage.md)문서를 참조하세요.

    1. 주간 검사를 자동으로 실행하여 잘못된 보안 구성을 탐지하도록 취약성 평가를 구성하려면 **정기적 반복 검사** 를 **켜기** 로 설정합니다. 결과는 **검사 보고를 보내도록** 제공한 메일 주소로 전송됩니다. 또한 **관리자 및 구독 소유자에게 메일 알림을 보내도록** 설정하여 관리자 및 구독 소유자에게 메일 알림을 보낼 수 있습니다.

1. SQL 취약성 평가 검사는 주문형으로 실행할 수도 있습니다.

    1. 리소스의 **Security Center** 페이지에서 **취약성 평가의 추가 검사 결과 보기** 를 선택하여 이전 검사의 결과에 액세스할 수 있습니다.

        :::image type="content" source="media/sql-vulnerability-assessment/view-additional-findings-link.png" alt-text="검사 결과 및 수동 검사 옵션 열기":::

    1. 주문형 검사를 실행하여 데이터베이스에서 취약성을 검사하려면 도구 모음에서 **검사** 를 선택합니다.

        :::image type="content" source="media/sql-vulnerability-assessment/on-demand-vulnerability-scan.png" alt-text="검사를 선택하여 SQL 리소스의 주문형 취약성 평가 검사를 실행합니다.":::


  > [!NOTE]
  > 검색 작업은 간단하며 안전합니다. 실행하는 데 몇 초 정도 소요되며 모두 읽기 전용입니다. 데이터베이스에 어떠한 변경도 발생하지 않습니다.

## <a name="remediate-vulnerabilities"></a>취약성 해결

취약성 검사가 완료되면 보고서가 Azure Portal에 표시됩니다. 보고서는 다음 정보를 제공합니다.

- 보안 상태 개요
- 발견된 문제 수
- 위험의 심각도별 요약
- 추가 조사 결과 목록

:::image type="content" source="media/sql-vulnerability-assessment/sample-sql-vulnerabilities-report.png" alt-text="SQL 취약성 평가 스캐너의 Sampl 검사 보고서":::

발견된 취약성을 해결하려면 다음과 같이 합니다.

1. 결과를 검토하여 보고서의 결과 중 사용자 환경에서 실제로 발생하는 보안 문제가 무엇인지 확인합니다.

1. 실패한 각 결과를 선택하여 그 결과가 끼치는 영향과 보안 검사에 실패한 이유를 파악합니다.

    > [!TIP]
    > 결과 세부 정보 페이지에는 문제 해결 방법을 설명하는 실행 가능한 수정 정보가 포함되어 있습니다.

    :::image type="content" source="media/sql-vulnerability-assessment/examining-vulnerability-findings.gif" alt-text="취약성 검사에서 발견된 내용 검사":::

1. 평가 결과를 검토할 때 특정 결과를 해당 환경에서 허용 가능한 *기준* 으로 표시할 수 있습니다. 기준은 기본적으로 사용자 맞춤형으로 설정된 결과 보고 방법입니다. 후속 검사에서 기준과 일치하는 결과는 통과로 간주됩니다. 보안 상태 기준을 설정한 후에는, 기준에서 편차가 발생했을 때만 취약성 평가에서 보고합니다. 이렇게 하면 관련 문제에 집중할 수 있습니다.

    :::image type="content" source="media/sql-vulnerability-assessment/baseline-approval.png" alt-text="결과를 향후 검사를 위한 기준으로 승인":::

1. 기준을 변경하는 경우 **검사** 단추를 사용하여 주문형 검사를 실행하고 사용자 지정된 보고서를 볼 수 있습니다. 기준에 추가한 모든 탐색 결과는 이제 기준이 변경되었기 때문에 **통과** 로 판정됩니다.

    :::image type="content" source="media/sql-vulnerability-assessment/passed-per-custom-baseline.png" alt-text="사용자 지정된 기준에 따라 통과했음을 나타내는 통과 판정을 받은 평가":::

이제 취약성 평가 검사를 사용하여 데이터베이스가 항상 높은 수준의 보안을 유지하고 조직의 정책이 충족하게 할 수 있습니다. 

## <a name="advanced-capabilities"></a>고급 기능

### <a name="export-an-assessment-report"></a>평가 보고서 내보내기

**검사 결과 내보내기** 를 선택하여 다운로드 가능한 검사 결과의 Excel 보고서를 만듭니다. 이 보고서에는 평가의 요약 정보를 표시하는 요약 탭이 있습니다. 보고서에는 실패한 검사도 모두 포함됩니다. **결과** 탭에는 검사 결과의 모든 사항이 포함됩니다. 결과에는 과거 실행된 모든 검사와 각 검사에 대한 결과 정보가 포함됩니다.

### <a name="view-scan-history"></a>검색 기록 보기

취약성 평가 창에서 **검사 기록** 을 선택하여 이전에 이 데이터베이스에서 실행된 모든 검사 기록을 확인합니다. 자세한 검색 결과를 보려면 목록에서 특정 검색을 선택합니다.

## <a name="manage-vulnerability-assessments-programmatically"></a>프로그래밍 방식으로 취약성 평가 관리

### <a name="using-azure-powershell"></a>Azure PowerShell 사용

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> PowerShell Azure Resource Manager 모듈은 여전히 지원되지만 향후 모든 개발은 Az.Sql 모듈에 집중됩니다. 이러한 cmdlet은 [AzureRM.Sql](/powershell/module/AzureRM.Sql/)을 참조하세요. Az 모듈 및 AzureRm 모듈의 명령에 대한 인수는 실질적으로 동일합니다.

Azure PowerShell cmdlet을 사용하여 취약성 평가를 프로그래밍 방식으로 관리할 수 있습니다. 지원되는 cmdlet은 다음과 같습니다.

| 링크된 Cmdlet 이름 | 설명 |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | 취약성 평가 규칙 기준을 지웁니다.<br/>우선 cmdlet을 사용하여 지우기 전에 기준을 설정합니다. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | 데이터베이스의 취약성 평가 설정을 지웁니다. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | 관리형 데이터베이스의 취약성 평가 규칙 기준을 지웁니다.<br/>우선 cmdlet을 사용하여 지우기 전에 기준을 설정합니다. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | 관리형 데이터베이스의 취약성 평가 설정을 지웁니다. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | 관리형 인스턴스의 취약성 평가 설정을 지웁니다. |
| [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | 데이터베이스의 취약성 평가 검사 결과를 Excel 파일로 변환합니다. |
| [Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | 관리형 데이터베이스의 취약성 평가 검사 결과를 Excel 파일로 변환합니다. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | 지정된 규칙에 의한 데이터베이스의 취약성 평가 규칙 기준을 가져옵니다. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | 지정된 규칙에 대한 관리형 데이터베이스의 취약성 평가 규칙 기준을 가져옵니다. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | 지정된 데이터베이스와 연관된 모든 취약성 평가 검사 기록을 가져옵니다. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | 지정된 데이터베이스와 연관된 모든 취약성 평가 검사 레코드를 가져옵니다. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | 데이터베이스의 취약성 평가 설정을 되돌립니다. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | 관리형 데이터베이스의 취약성 평가 설정을 되돌립니다. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | 취약성 평가 규칙 기준을 설정합니다. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | 관리형 데이터베이스에 대한 취약성 평가 규칙 기준을 설정합니다. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | 데이터에 대한 취약성 평가 검사 시작을 트리거합니다. |
| [Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | 관리형 데이터베이스에 대한 취약성 평가 검사의 시작을 트리거합니다. |
| [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | 데이터베이스의 취약성 평가 설정을 업데이트합니다. |
| [Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | 관리형 데이터베이스의 취약성 평가 설정을 업데이트합니다. |
| [Update-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | 관리형 인스턴스의 취약성 평가 설정을 업데이트합니다. |
| &nbsp; | &nbsp; |

스크립트 예제를 보려면 [Azure SQL 취약성 평가 PowerShell 지원](/archive/blogs/sqlsecurity/azure-sql-vulnerability-assessment-now-with-powershell-support)을 참조하세요.

### <a name="using-resource-manager-templates"></a>Resource Manager 템플릿 사용

Azure Resource Manager 템플릿을 사용하여 취약성 평가 기준을 구성하려면 `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` 유형을 사용합니다.

기준을 추가하기 전에 `vulnerabilityAssessments`을(를) 사용하도록 설정했는지 확인합니다.

다음은 리소스 관리자 템플릿에서 기준 규칙 VA2065를 `master` 데이터베이스에 정의하고 VA1143을 리소스로 `user` 데이터베이스에 정의하는 예시입니다.

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

`master` 데이터베이스 및 `user` 데이터베이스의 경우 리소스 이름은 다음과 같이 다르게 정의됩니다.

- Master database - "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
- User database - "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",

부울 형식을 true/false로 처리하려면 “1”/”0” 같은 이진 입력을 사용하여 기준 결과를 설정합니다.

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>다음 단계  

- [Azure Defender for SQL](azure-defender-for-sql.md)에 대해 자세히 알아봅니다.
- [데이터 검색 및 분류](data-discovery-and-classification-overview.md)에 대한 자세한 정보를 알아봅니다.
- [방화벽 및 VNet 뒤로 액세스할 수 있는 스토리지 계정에 취약성 평가 검사 결과 저장](sql-database-vulnerability-assessment-storage.md)에 대한 자세한 정보를 알아봅니다.