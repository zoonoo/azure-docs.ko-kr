---
title: Azure 파일 동기화 클라우드 계층화 정책 | Microsoft Docs
description: 다양한 시나리오에서 날짜 및 볼륨의 사용 가능한 공간 정책이 함께 작동하는 방법에 대한 세부 정보입니다.
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 04/13/2021
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: 4376a57b677b95b2de7d261b30ac4c0ad24956cc
ms.sourcegitcommit: 4b0e424f5aa8a11daf0eec32456854542a2f5df0
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/20/2021
ms.locfileid: "107796519"
---
# <a name="cloud-tiering-policies"></a>클라우드 계층화 정책

클라우드 계층화에는 클라우드로 계층화되는 파일을 결정하는 두 가지 정책, 즉 **사용 가능한 볼륨 공간 정책** 과 **날짜 정책** 이 있습니다.

**사용 가능한 볼륨 공간 정책** 은 서버 엔드포인트가 있는 로컬 볼륨의 지정된 백분율이 항상 사용 가능한 상태로 유지되도록 합니다. 

마지막으로 x일 전에 마지막으로 액세스한 **날짜 정책** 계층 파일입니다. 사용 가능한 볼륨 공간 정책은 항상 우선 순위를 가지며, 날짜 정책에서 설명된 대로 볼륨에 파일을 저장할 충분한 공간이 없는 경우 Azure 파일 동기화는 날짜 정책을 재정의하고 사용 가능한 볼륨 공간 백분율이 충족될 때까지 콜드 파일 계층화를 계속합니다.

## <a name="how-both-policies-work-together"></a>두 정책 모두 함께 작동하는 방법

정책이 어떻게 작동하는지 설명하기 위해 예제를 사용하겠습니다. 500GB 로컬 볼륨에 Azure 파일 동기화를 구성했으며 클라우드 계층화를 사용하도록 설정하지 않은 경우를 가정해 보겠습니다. 파일 공유의 파일은 다음과 같습니다.

|파일 이름 |마지막으로 액세스한 시간  |파일 크기  |저장 위치 |
|----------|------------------|-----------|----------|
|파일 1    | 2일 전  | 10GB | 서버 및 Azure 파일 공유
|파일 2    | 10일 전 | 30GB | 서버 및 Azure 파일 공유
|파일 3    | 1년 전 | 200GB | 서버 및 Azure 파일 공유
|파일 4    | 1년, 2일 전 | 130GB | 서버 및 Azure 파일 공유
|파일 5    | 2년, 1일 전 | 140GB | 서버 및 Azure 파일 공유

**변경 1:** 클라우드 계층화를 사용하도록 설정하고, 사용 가능한 볼륨 공간 정책을 20%로 설정하고, 날짜 정책을 사용하지 않도록 설정했습니다. 클라우드 계층화를 사용하면 이 구성을 사용하여 20%(이 경우 100GB)의 공간을 확보하고 로컬 컴퓨터에서 사용할 수 있습니다. 따라서 로컬 캐시의 총 용량은 400GB입니다. 이 400GB는 가장 최근에 액세스한 파일을 로컬 볼륨에 저장합니다.

이 구성을 사용하면 1~ 4파일만 로컬 캐시에 저장되고 파일 5는 계층화됩니다. 이는 사용할 수 있는 400GB 중 370GB에 불과합니다. 파일 5는 140GB이고, 로컬로 캐시할 경우 400GB 제한이 초과됩니다. 

**변경 2:** 사용자가 파일 5에 액세스 한다고 가정합니다. 이렇게 하면 파일 5가 공유에서 가장 최근에 액세스한 파일을 사용합니다. 따라서 파일 5는 로컬 캐시에 저장되고 400GB 제한에 맞게 파일 4가 계층화됩니다. 다음 표에서는 이러한 업데이트를 사용하여 파일이 저장되는 위치를 보여 줍니다.

|파일 이름 |마지막으로 액세스한 시간  |파일 크기  |저장 위치 |
|----------|------------------|-----------|----------|
|파일 5    | 2시간 전 | 140GB | 서버 및 Azure 파일 공유
|파일 1    | 2일 전  | 10GB | 서버 및 Azure 파일 공유
|파일 2    | 10일 전 | 30GB | 서버 및 Azure 파일 공유
|파일 3    | 1년 전 | 200GB | 서버 및 Azure 파일 공유
|파일 4    | 1년, 2일 전 | 130GB | 로컬로 계층화된 Azure 파일 공유

**변경 3:** 날짜 기반 계층화 정책을 60일로 지정하고 사용 가능한 볼륨 공간 정책이 70%가 되도록 정책을 업데이트 했다고 가정해 보겠습니다. 이제 로컬 캐시에 150GB까지만 저장할 수 있습니다. 파일 2에 60일 액세스한 날짜가 60일이 지나지 않았지만 사용 가능한 볼륨 공간 정책이 날짜 정책을 재정의하며 사용 가능한 로컬 공간을 70%로 유지하도록 파일 2가 계층화됩니다.

**변경 4:** 사용 가능한 볼륨 공간 정책을 20%로 변경한 다음 `Invoke-StorageSyncFileRecall`을 사용하여 클라우드 계층화 정책을 준수하는 동시에 모든 파일이 로컬 드라이브에 맞도록 하며, 테이블은 다음과 같습니다.

|파일 이름 |마지막으로 액세스한 시간  |파일 크기  |저장 위치 |
|----------|------------------|-----------|----------|
|파일 5    | 1시간 전  | 140GB | 서버 및 Azure 파일 공유
|파일 1    | 2일 전  | 10GB | 서버 및 Azure 파일 공유
|파일 2    | 10일 전 | 30GB | 서버 및 Azure 파일 공유
|파일 3    | 1년 전 | 200GB | 로컬로 계층화된 Azure 파일 공유
|파일 4    | 1년, 2일 전 | 130GB | 로컬로 계층화된 Azure 파일 공유

이 경우 파일 1, 2, 5는 로컬로 캐시되고 파일 3과 4는 계층화됩니다. 날짜 정책이 60일이기 때문에 파일 3 및 4는 볼륨의 사용 가능한 공간 정책이 로컬에서 최대 400GB를 허용하더라도 계층화됩니다.

> [!NOTE] 
> 고객이 볼륨 사용 가능 공간 정책을 더 작은 값(예: 20%에서 10%로)으로 변경하거나 날짜 정책을 더 큰 값으로 변경(예: 20일에서 50일로)하면 파일이 자동으로 회수되지 않습니다.

## <a name="multiple-server-endpoints-on-a-local-volume"></a>로컬 볼륨의 여러 서버 엔드포인트

단일 로컬 볼륨의 여러 서버 엔드포인트에 대해 클라우드 계층화를 사용하도록 설정할 수 있습니다. 이 구성에서는 동일한 볼륨의 모든 서버 엔드포인트에 대해 사용 가능한 볼륨 공간을 동일한 양으로 설정해야 합니다. 동일한 볼륨의 여러 서버 엔드포인트에 대해 사용 가능한 볼륨 공간 정책을 여러 개 설정하면 사용 가능한 최대 볼륨 공간 백분율이 우선적으로 적용됩니다. 이를 **사용 가능한 유효 볼륨 공간 정책** 이라고 합니다. 예를 들어 세 개의 서버 엔드포인트가 동일한 로컬 볼륨에 있으며 하나는 15%, 하나는 20%, 세 번째는 30%로 설정되면 사용 가능한 공간이 30% 미만이 되었을 때 모두 콜드 파일 계층화를 시작합니다.

## <a name="next-steps"></a>다음 단계

* [클라우드 계층화 모니터링](file-sync-monitor-cloud-tiering.md)
